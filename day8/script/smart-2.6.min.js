/*
 jSmart Javascript template engine
 http://code.google.com/p/jsmart/

 Copyright 2011, Max Miroshnikov <miroshnikov at gmail dot com> 
 jSmart is licensed under the GNU Lesser General Public License
 http://www.gnu.org/licenses/lgpl.html
*/
(function(){function F(a){for(var b=1;b<arguments.length;++b)for(b=1;b<arguments.length;++b)for(var c in arguments[b])a[c]=arguments[b][c];return a}function T(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}function U(a,b){if(Array.prototype.indexOf)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}function K(a){return a.replace(/\\t/,"\t").replace(/\\n/,"\n").replace(/\\(['"\\])/g,"$1")}function C(a){return K(a.replace(/^['"](.*)['"]$/,"$1")).replace(/^\s+|\s+$/g,
"")}function w(a,b){var c=0,d=0,e=jSmart.prototype.left_delimiter,f=jSmart.prototype.right_delimiter,g=jSmart.prototype.auto_literal,h=/^\s*(.+)\s*$/i;h=a?RegExp("^\\s*("+a+")\\s*$","i"):h;for(var i=0;i<b.length;++i)if(b.substr(i,e.length)==e){if(!(g&&i+1<b.length&&b.substr(i+1,1).match(/\s/))){if(!c){b=b.slice(i);d+=parseInt(i);i=0}++c}}else if(b.substr(i,f.length)==f)if(!(g&&i-1>=0&&b.substr(i-1,1).match(/\s/))){if(!--c){var k=b.slice(e.length,i).replace(/[\r\n]/g," ").match(h);if(k){k[0]=b.slice(0,
i+f.length);k.index=d;return k}}if(c<0)c=0}return null}function L(a,b,c){var d="",e=null,f=null,g=0;do{if(e)g+=e[0].length;e=w(a,c);if(!e)throw Error("Unclosed {"+b+"}");d+=c.slice(0,e.index);g+=e.index;c=c.slice(e.index+e[0].length);if(f=w(b,d))d=d.slice(f.index+f[0].length)}while(f);e.index=g;return e}function G(a,b,c,d){for(var e=0,f=w(c,d);f;f=w(c,d)){var g=w(a,d);if(!g||g.index>f.index){f.index+=e;return f}else{d=d.slice(g.index+g[0].length);e+=g.index+g[0].length;f=L(b,a,d);d=d.slice(f.index+
f[0].length);e+=f.index+f[0].length}}return null}function M(a,b){if(typeof a=="string")with({__code:a})with(N)with(b)try{return eval(__code)}catch(c){throw Error(c.message+" in \n"+a);}return a}function r(a,b,c){if(a.match(/\[\]$/))c[a.replace(/\[\]$/,"")].push(b);else c[a]=b}function j(a,b){for(var c=w("",a);c;c=w("",a)){c.index&&o(a.slice(0,c.index),b);a=a.slice(c.index+c[0].length);var d=c[1].match(/^\s*(\w+)(.*)$/);if(d){var e=d[1];d=d.length>2?d[2]:"";if(e in H){var f=H[e];d="parseParams"in f?
f.parseParams(d):x(d);if(f.type=="block"){a=a.replace(/^\n/,"");c=L("/"+e,e+" +[^}]*",a);f.parse(d,b,a.slice(0,c.index));a=a.slice(c.index+c[0].length)}else{f.parse(d,b);if(e=="extends")b=[]}a=a.replace(/^\n/,"")}else if(e in t){c=t[e];if(c.type=="block"){c=L("/"+e,e+" +[^}]*",a);d=x(d);f=a.slice(0,c.index);b.push({type:"plugin",name:e,params:d,subTree:j(f,[])});a=a.slice(c.index+c[0].length)}else if(c.type=="function"){c=x(d);b.push({type:"plugin",name:e,params:c})}if(e=="append"||e=="assign"||e==
"capture"||e=="eval"||e=="include"||e=="while"||e=="nocache")a=a.replace(/^\n/,"")}else b.push(D(c[1]).tree)}else{c=c[1];if(e=c.match(/\s+nofilter*$/))c=c.substring(0,e.index);else e=!jSmart.prototype.escape_html;c=D(c).tree;if(c.type=="build-in"&&c.name=="__operator"&&c.op=="=")a=a.replace(/^\n/,"");else if(!e){e=[c];e.name={data:"escape",type:"text"};c={name:"__func",type:"plugin",params:{__parsed:e}}}b.push(c)}}a&&o(a,b);return b}function o(a,b){if(o.parseEmbeddedVars)for(var c=/([$][\w@]+)|`([^`]*)`/,
d=a.match(c);d;d=a.match(c)){b.push({type:"text",data:a.slice(0,d.index)});b.push(D(d[1]?d[1]:d[2]).tree);a=a.slice(d.index+d[0].length)}b.push({type:"text",data:a});return b}function V(a,b,c){b.__parsed.name=o(a,[])[0];c.push({type:"plugin",name:"__func",params:b});return c}function l(a,b,c,d){d.push({type:"build-in",name:"__operator",op:a,optype:b,precedence:c,params:{}})}function O(a,b,c){var d=b.token;c=[{type:"text",data:c.replace(/^(\w+)@(index|iteration|first|last|show|total)/gi,"$1__$2")}];
for(var e=/^(?:\.|->|\[\s*)/,f=a.match(e);f;f=a.match(e)){b.token+=f[0];a=a.slice(f[0].length);var g={value:"",tree:[]};if(f[0].match(/\[/)){if(g=D(a)){b.token+=g.value;c.push(g.tree);a=a.slice(g.value.length)}if(f=a.match(/\s*\]/)){b.token+=f[0];a=a.slice(f[0].length)}}else{f=p.stop;p.stop=true;if(P(a,g)){b.token+=g.value;var h=g.tree[0];if(h.type=="plugin"&&h.name=="__func")h.hasOwner=true;c.push(h);a=a.slice(g.value.length)}else g=false;p.stop=f}g||c.push({type:"text",data:""})}b.tree.push({type:"var",
parts:c});b.value+=b.token.substr(d.length);Q(b.token);return a}function Q(){}function p(a,b){if(!p.stop){var c=a.match(/^\|(\w+)/);if(c){b.value+=c[0];var d=c[1]=="default"?"defaultValue":c[1];a=a.slice(c[0].length).replace(/^\s+/,"");p.stop=true;c=[];for(var e=a.match(/^\s*:\s*/);e;e=a.match(/^\s*:\s*/)){b.value+=a.slice(0,e[0].length);a=a.slice(e[0].length);e={value:"",tree:[]};if(P(a,e)){b.value+=e.value;c.push(e.tree[0]);a=a.slice(e.value.length)}else o("",c)}p.stop=false;c.unshift(b.tree.pop());
b.tree.push(V(d,{__parsed:c},[])[0]);p(a,b)}}}function P(a,b){if(!a)return false;if(a.substr(0,jSmart.prototype.left_delimiter.length)==jSmart.prototype.left_delimiter){var c=w("",a);if(c){b.token=c[0];b.value+=c[0];j(c[0],b.tree);p(a.slice(b.value.length),b);return true}}for(c=0;c<I.length;++c)if(a.match(I[c].re)){b.token=RegExp.lastMatch;b.value+=RegExp.lastMatch;I[c].parse(b,a.slice(b.token.length));return true}return false}function W(a,b,c){var d=b[a];if(d.name=="__operator"&&d.precedence==c&&
!d.params.__parsed){if(d.optype=="binary"){d.params.__parsed=[b[a-1],b[a+1]];b.splice(a-1,3,d);return true}else if(d.optype=="post-unary"){d.params.__parsed=[b[a-1]];b.splice(a-1,2,d);return true}d.params.__parsed=[b[a+1]];b.splice(a,2,d)}return false}function X(a){var b=0;for(b=0;b<a.length;++b)if(a[b]instanceof Array)a[b]=X(a[b]);for(var c=1;c<14;++c)if(c==2||c==10)for(b=a.length;b>0;--b)b-=W(b-1,a,c);else for(b=0;b<a.length;++b)b-=W(b,a,c);return a[0]}function D(a){for(var b={value:"",tree:[]};P(a.slice(b.value.length),
b););if(!b.tree.length)return false;b.tree=X(b.tree);return b}function x(a,b,c){var d=a.replace(/\n/g," ").replace(/^\s+|\s+$/g,""),e=[];e.__parsed=[];a="";if(!d)return e;if(!b){b=/^\s+/;c=/^(\w+)\s*=\s*/}for(;d;){var f=null;if(c){var g=d.match(c);if(g){f=C(g[1]);a+=d.slice(0,g[0].length);d=d.slice(g[0].length)}}g=D(d);if(!g)break;if(f){e[f]=g.value;e.__parsed[f]=g.tree}else{e.push(g.value);e.__parsed.push(g.tree)}a+=d.slice(0,g.value.length);d=d.slice(g.value.length);if(f=d.match(b)){a+=d.slice(0,
f[0].length);d=d.slice(f[0].length)}else break}e.toString=function(){return a};return e}function v(a,b){var c=[],d;for(d in a.__parsed)if(a.__parsed.hasOwnProperty(d)){var e=m([a.__parsed[d]],b);if(typeof e=="string"&&e.match(/^[1-9]\d*$/)&&!isNaN(e))e=parseInt(e,10);c[d]=e}c.__get=function(f,g,h){if(f in c&&typeof c[f]!="undefined")return c[f];if(typeof h!="undefined"&&typeof c[h]!="undefined")return c[h];if(g===null)throw Error("The required attribute '"+f+"' is missing");return g};return c}function y(a,
b,c){for(var d=b,e="",f=0;f<a.parts.length;++f){var g=a.parts[f];if(g.type=="plugin"&&g.name=="__func"&&g.hasOwner){b.__owner=d;d=m([a.parts[f]],b);delete b.__owner}else{e=m([g],b);if(e in b.smarty.section&&g.type=="text"&&m([a.parts[0]],b)!="smarty")e=b.smarty.section[e].index;if(!e&&typeof c!="undefined"&&d instanceof Array)e=d.length;if(typeof c!="undefined"&&f==a.parts.length-1)d[e]=c;if(!(typeof d=="object"&&d!==null&&e in d)){if(typeof c=="undefined")return"";d[e]={}}d=d[e]}}return d}function m(a,
b){for(var c="",d=0;d<a.length;++d){var e="",f=a[d];if(f.type=="text")e=f.data;else if(f.type=="var")e=y(f,b);else if(f.type=="build-in")e=H[f.name].process(f,b);else if(f.type=="plugin"){var g=t[f.name];if(g.type=="block"){g={value:true};for(t[f.name].process(v(f.params,b),"",b,g);g.value;){g.value=false;e+=t[f.name].process(v(f.params,b),m(f.subTree,b),b,g)}}else if(g.type=="function")e=t[f.name].process(v(f.params,b),b)}if(typeof e=="boolean")e=e?"1":"";if(a.length==1)return e;c+=e}return c}function R(a){for(var b=
"",c=a.match(/{\*/);c;c=a.match(/{\*/)){b+=a.slice(0,c.index);a=a.slice(c.index+c[0].length);c=a.match(/\*}/);if(!c)throw Error("Unclosed {*");a=a.slice(c.index+c[0].length);if(b.match(/\n+$/)&&a.match(/^\n+/)){b=b.replace(/\n+$/,"\n");a=a.replace(/^\n/,"")}}return b+a}var H={__operator:{process:function(a,b){var c=v(a.params,b),d=c[0];if(a.optype=="binary"){c=c[1];if(a.op=="="){y(a.params.__parsed[0],b,c);return""}else if(a.op.match(/(\+=|-=|\*=|\/=|%=)/)){d=y(a.params.__parsed[0],b);switch(a.op){case "+=":d+=
c;break;case "-=":d-=c;break;case "*=":d*=c;break;case "/=":d/=c;break;case "%=":d%=c}return y(a.params.__parsed[0],b,d)}else if(a.op.match(/div/))return a.op!="div"^d%c==0;else if(a.op.match(/even/))return a.op!="even"^d/c%2==0;else if(a.op.match(/xor/))return(d||c)&&!(d&&c);switch(a.op){case "==":return d==c;case "!=":return d!=c;case "+":return d+c;case "-":return d-c;case "*":return d*c;case "/":return d/c;case "%":return d%c;case "&&":return d&&c;case "||":return d||c;case "<":return d<c;case "<=":return d<=
c;case ">":return d>c;case ">=":return d>=c;case "===":return d===c;case "!==":return d!==c}}else if(a.op=="!")return!d;else{if(c=a.params.__parsed[0].type=="var")d=y(a.params.__parsed[0],b);var e=d;if(a.optype=="pre-unary"){switch(a.op){case "-":e=-d;break;case "++":e=++d;break;case "--":e=--d}c&&y(a.params.__parsed[0],b,d)}else{switch(a.op){case "++":d++;break;case "--":d--}y(a.params.__parsed[0],b,d)}return e}}},section:{type:"block",parse:function(a,b,c){var d=[],e=[];b.push({type:"build-in",
name:"section",params:a,subTree:d,subTreeElse:e});if(a=G("section [^}]+","/section","sectionelse",c)){j(c.slice(0,a.index),d);j(c.slice(a.index+a[0].length).replace(/^[\r\n]/,""),e)}else j(c,d)},process:function(a,b){var c=v(a.params,b),d={};b.smarty.section[c.name]=d;var e=c.__get("show",true);d.show=e;if(!e)return m(a.subTreeElse,b);e=parseInt(c.__get("start",0));var f=c.loop instanceof Object?T(c.loop):isNaN(c.loop)?0:parseInt(c.loop),g=parseInt(c.__get("step",1));c=parseInt(c.__get("max"));if(isNaN(c))c=
Number.MAX_VALUE;if(e<0){e+=f;if(e<0)e=0}else if(e>=f)e=f?f-1:0;for(var h=0,i=e;i>=0&&i<f&&h<c;i+=g,++h);d.total=h;d.loop=h;h=0;var k="";for(i=e;i>=0&&i<f&&h<c;i+=g,++h){d.first=i==e;d.last=i+g<0||i+g>=f;d.index=i;d.index_prev=i-g;d.index_next=i+g;d.iteration=d.rownum=h+1;k+=m(a.subTree,b)}if(h)return k;return m(a.subTreeElse,b)}},"for":{type:"block",parseParams:function(a){var b=a.match(/^\s*\$(\w+)\s*=\s*([^\s]+)\s*to\s*([^\s]+)\s*(?:step\s*([^\s]+))?\s*(.*)$/);if(!b)throw Error("Invalid {for} parameters: "+
a);return x("varName='"+b[1]+"' from="+b[2]+" to="+b[3]+" step="+(b[4]?b[4]:"1")+" "+b[5])},parse:function(a,b,c){var d=[],e=[];b.push({type:"build-in",name:"for",params:a,subTree:d,subTreeElse:e});if(a=G("for\\s[^}]+","/for","forelse",c)){j(c.slice(0,a.index),d);j(c.slice(a.index+a[0].length),e)}else j(c,d)},process:function(a,b){var c=v(a.params,b),d=parseInt(c.__get("from")),e=parseInt(c.__get("to")),f=parseInt(c.__get("step"));if(isNaN(f))f=1;var g=parseInt(c.__get("max"));if(isNaN(g))g=Number.MAX_VALUE;
var h=0,i="";d=Math.min(Math.ceil(((f>0?e-d:d-e)+1)/Math.abs(f)),g);for(e=parseInt(c.from);h<d;e+=f,++h){b[c.varName]=e;i+=m(a.subTree,b)}h||(i=m(a.subTreeElse,b));return i}},"if":{type:"block",parse:function(a,b,c){var d=[],e=[];b.push({type:"build-in",name:"if",params:a,subTreeIf:d,subTreeElse:e});if(a=G("if\\s+[^}]+","/if","else[^}]*",c)){j(c.slice(0,a.index),d);c=c.slice(a.index+a[0].length);(d=a[1].match(/^elseif(.*)/))?H["if"].parse(x(d[1]),e,c.replace(/^\n/,"")):j(c.replace(/^\n/,""),e)}else j(c,
d)},process:function(a,b){return v(a.params,b)[0]?m(a.subTreeIf,b):m(a.subTreeElse,b)}},foreach:{type:"block",parseParams:function(a){var b=a.match(/^\s*([$].+)\s*as\s*[$](\w+)\s*(=>\s*[$](\w+))?\s*$/i);if(b){a="from="+b[1]+" item="+(b[4]||b[2]);if(b[4])a+=" key="+b[2]}return x(a)},parse:function(a,b,c){var d=[],e=[];b.push({type:"build-in",name:"foreach",params:a,subTree:d,subTreeElse:e});if(a=G("foreach\\s[^}]+","/foreach","foreachelse",c)){j(c.slice(0,a.index),d);j(c.slice(a.index+a[0].length).replace(/^[\r\n]/,
""),e)}else j(c,d)},process:function(a,b){var c=v(a.params,b),d=c.from;d instanceof Object||(d=[d]);var e=T(d);b[c.item+"__total"]=e;if("name"in c){b.smarty.foreach[c.name]={};b.smarty.foreach[c.name].total=e}var f="",g=0,h;for(h in d)if(d.hasOwnProperty(h)){b[c.item+"__key"]=isNaN(h)?h:parseInt(h);if("key"in c)b[c.key]=b[c.item+"__key"];b[c.item]=d[h];b[c.item+"__index"]=parseInt(g);b[c.item+"__iteration"]=parseInt(g+1);b[c.item+"__first"]=g===0;b[c.item+"__last"]=g==e-1;if("name"in c){b.smarty.foreach[c.name].index=
parseInt(g);b.smarty.foreach[c.name].iteration=parseInt(g+1);b.smarty.foreach[c.name].first=g===0?1:"";b.smarty.foreach[c.name].last=g==e-1?1:""}f+=m(a.subTree,b);++g}b[c.item+"__show"]=g>0;if(c.name)b.smarty.foreach[c.name].show=g>0?1:"";if(g>0)return f;return m(a.subTreeElse,b)}},"function":{type:"block",parse:function(a,b,c){b=[];t[C(a.name?a.name:a[0])]={type:"function",subTree:b,defautParams:a,process:function(d,e){var f=v(this.defautParams,e);delete f.name;return m(this.subTree,F({},e,f,d))}};
j(c.replace(/\n+$/,""),b)}},php:{type:"block",parse:function(){}},"extends":{type:"function",parse:function(a,b){var c=C(a.file?a.file:a[0]),d=jSmart.prototype.getTemplate(c);if(typeof d!="string")throw Error("No template for "+c);j(R(d.replace(/\r\n/g,"\n")),b)}},block:{type:"block",parse:function(a,b,c){b.push({type:"build-in",name:"block",params:a});a.append=U(a,"append")>=0;a.prepend=U(a,"prepend")>=0;a.hasChild=a.hasParent=false;Q=function(d){if(d.match(/^\s*[$]smarty.block.child\s*$/))a.hasChild=
true;if(d.match(/^\s*[$]smarty.block.parent\s*$/))a.hasParent=true};b=j(c,[]);Q=function(){};c=C(a.name?a.name:a[0]);c in z||(z[c]=[]);z[c].push({tree:b,params:a})},process:function(a,b){b.smarty.block.parent=b.smarty.block.child="";var c=C(a.params.name?a.params.name:a.params[0]);this.processBlocks(z[c],z[c].length-1,b);return b.smarty.block.child},processBlocks:function(a,b,c){var d=true,e=false;for(b=b;b>=0;--b){if(a[b].params.hasParent){var f=c.smarty.block.child;c.smarty.block.child="";this.processBlocks(a,
b-1,c);c.smarty.block.parent=c.smarty.block.child;c.smarty.block.child=f}f=c.smarty.block.child;var g=m(a[b].tree,c);c.smarty.block.child=f;if(a[b].params.hasChild)c.smarty.block.child=g;else if(d)c.smarty.block.child=g+c.smarty.block.child;else if(e)c.smarty.block.child+=g;d=a[b].params.append;e=a[b].params.prepend}}},strip:{type:"block",parse:function(a,b,c){j(c.replace(/[ \t]*[\r\n]+[ \t]*/g,""),b)}},literal:{type:"block",parse:function(a,b,c){o(c,b)}},ldelim:{type:"function",parse:function(a,
b){o(jSmart.prototype.left_delimiter,b)}},rdelim:{type:"function",parse:function(a,b){o(jSmart.prototype.right_delimiter,b)}}},t={},N={},J={},z=null,S=null,I=[{re:/^\$([\w@]+)/,parse:function(a,b){p(O(b,a,RegExp.$1),a)}},{re:/^(true|false)/i,parse:function(a){o(a.token.match(/true/i)?"1":"",a.tree)}},{re:/^'([^'\\]*(?:\\.[^'\\]*)*)'/,parse:function(a,b){o(K(RegExp.$1),a.tree);p(b,a)}},{re:/^"([^"\\]*(?:\\.[^"\\]*)*)"/,parse:function(a,b){var c=K(RegExp.$1),d=c.match(I[0].re);if(d){var e={token:d[0],
tree:[]};O(c,e,d[1]);if(e.token.length==c.length){a.tree.push(e.tree[0]);return}}d=[];o.parseEmbeddedVars=true;j(c,d);o.parseEmbeddedVars=false;d.length==1?a.tree.push(d[0]):a.tree.push({type:"plugin",name:"__quoted",params:{__parsed:d}});p(b,a)}},{re:/^(\w+)\s*[(]/,parse:function(a,b){var c=RegExp.$1,d=x(b,/^\s*,\s*/);V(c,d,a.tree);a.value+=d.toString();p(b.slice(d.toString().length),a)}},{re:/^\s*\(\s*/,parse:function(a){var b=[];a.tree.push(b);b.parent=a.tree;a.tree=b}},{re:/^\s*\)\s*/,parse:function(a){if(a.tree.parent)a.tree=
a.tree.parent}},{re:/^\s*(\+\+|--)\s*/,parse:function(a){a.tree.length&&a.tree[a.tree.length-1].type=="var"?l(RegExp.$1,"post-unary",1,a.tree):l(RegExp.$1,"pre-unary",1,a.tree)}},{re:/^\s*(==|!=|===|!==)\s*/,parse:function(a){l(RegExp.$1,"binary",6,a.tree)}},{re:/^\s+(eq|ne|neq)\s+/i,parse:function(a){var b=RegExp.$1.replace(/ne(q)?/,"!=").replace(/eq/,"==");l(b,"binary",6,a.tree)}},{re:/^\s*!\s*/,parse:function(a){l("!","pre-unary",2,a.tree)}},{re:/^\s+not\s+/i,parse:function(a){l("!","pre-unary",
2,a.tree)}},{re:/^\s*(=|\+=|-=|\*=|\/=|%=)\s*/,parse:function(a){l(RegExp.$1,"binary",10,a.tree)}},{re:/^\s*(\*|\/|%)\s*/,parse:function(a){l(RegExp.$1,"binary",3,a.tree)}},{re:/^\s+mod\s+/i,parse:function(a){l("%","binary",3,a.tree)}},{re:/^\s*(\+|-)\s*/,parse:function(a){!a.tree.length||a.tree[a.tree.length-1].name=="__operator"?l(RegExp.$1,"pre-unary",4,a.tree):l(RegExp.$1,"binary",4,a.tree)}},{re:/^\s*(<|<=|>|>=|<>)\s*/,parse:function(a){l(RegExp.$1.replace(/<>/,"!="),"binary",5,a.tree)}},{re:/^\s+(lt|lte|le|gt|gte|ge)\s+/i,
parse:function(a){var b=RegExp.$1.replace(/lt/,"<").replace(/l(t)?e/,"<=").replace(/gt/,">").replace(/g(t)?e/,">=");l(b,"binary",5,a.tree)}},{re:/^\s+(is\s+(not\s+)?div\s+by)\s+/i,parse:function(a){l(RegExp.$2?"div_not":"div","binary",7,a.tree)}},{re:/^\s+is\s+(not\s+)?(even|odd)(\s+by\s+)?\s*/i,parse:function(a){l(RegExp.$1?RegExp.$2=="odd"?"even":"even_not":RegExp.$2=="odd"?"even_not":"even","binary",7,a.tree);RegExp.$3||o("1",a.tree)}},{re:/^\s*(&&)\s*/,parse:function(a){l(RegExp.$1,"binary",8,
a.tree)}},{re:/^\s*(\|\|)\s*/,parse:function(a){l(RegExp.$1,"binary",9,a.tree)}},{re:/^\s+and\s+/i,parse:function(a){l("&&","binary",11,a.tree)}},{re:/^\s+xor\s+/i,parse:function(a){l("xor","binary",12,a.tree)}},{re:/^\s+or\s+/i,parse:function(a){l("||","binary",13,a.tree)}},{re:/^#(\w+)#/,parse:function(a,b){var c={token:"$smarty",tree:[]};O(".config."+RegExp.$1,c,"smarty");a.tree.push(c.tree[0]);p(b,a)}},{re:/^\s*\[\s*/,parse:function(a,b){var c=x(b,/^\s*,\s*/,/^('[^'\\]*(?:\\.[^'\\]*)*'|"[^"\\]*(?:\\.[^"\\]*)*"|\w+)\s*=>\s*/);
a.tree.push({type:"plugin",name:"__array",params:c});a.value+=c.toString();if(c=b.slice(c.toString().length).match(/\s*\]/))a.value+=c[0]}},{re:/^[\d.]+/,parse:function(a,b){o(a.token,a.tree);p(b,a)}},{re:/^\w+/,parse:function(a,b){o(a.token,a.tree);p(b,a)}}];jSmart=function(a){this.tree=[];this.blocks={};this.scripts={};this.smarty={smarty:{block:{},capture:{},counter:{},cycle:{},foreach:{},section:{},now:Math.floor((new Date).getTime()/1E3),"const":{},config:{},current_dir:"/",template:"",ldelim:jSmart.prototype.left_delimiter,
rdelim:jSmart.prototype.right_delimiter,version:"2.6"}};z=this.blocks;j(R(a.replace(/\r\n/g,"\n")),this.tree)};jSmart.prototype.escape_html=false;jSmart.prototype.fetch=function(a){z=this.blocks;S=this.scripts;this.data=F(a,this.smarty);a=m(this.tree,this.data);jSmart.prototype.debugging&&t.debug.process([],this.data);return a};jSmart.prototype.registerPlugin=function(a,b,c){if(a=="modifier")N[b]=c;else t[b]={type:a,process:c}};jSmart.prototype.configLoad=function(a,b,c){c=c?c:this.data;a=a.replace(/\r\n/g,
"\n").replace(/^\s+|\s+$/g,"");for(var d=/^\s*(?:\[([^\]]+)\]|(?:(\w+)[ \t]*=[ \t]*("""|'[^'\\\n]*(?:\\.[^'\\\n]*)*'|"[^"\\\n]*(?:\\.[^"\\\n]*)*"|[^\n]*)))/m,e="",f=a.match(d);f;f=a.match(d)){a=a.slice(f.index+f[0].length);if(f[1])e=f[1];else if((!e||e==b)&&e.substr(0,1)!=".")if(f[3]=='"""'){var g=a.match(/"""/);if(g){c.smarty.config[f[2]]=a.slice(0,g.index);a=a.slice(g.index+g[0].length)}}else c.smarty.config[f[2]]=C(f[3]);if(f=a.match(/\n+/))a=a.slice(f.index+f[0].length);else break}};jSmart.prototype.clearConfig=
function(a){if(a)delete this.data.smarty.config[a];else this.data.smarty.config={}};jSmart.prototype.getTemplate=function(a){throw Error("No template for "+a);};jSmart.prototype.getFile=function(a){throw Error("No file for "+a);};jSmart.prototype.getJavascript=function(a){throw Error("No Javascript for "+a);};jSmart.prototype.getConfig=function(a){throw Error("No config for "+a);};jSmart.prototype.auto_literal=true;jSmart.prototype.left_delimiter="{";jSmart.prototype.right_delimiter="}";jSmart.prototype.debugging=
false;jSmart.prototype.PHPJS=function(a,b){if(eval("typeof "+a)=="function")return window;else if(typeof PHP_JS=="function")return new PHP_JS;throw Error("Modifier '"+b+"' uses JavaScript port of PHP function '"+a+"'. You can find one at http://phpjs.org");};jSmart.prototype.makeTimeStamp=function(a){if(!a)return Math.floor((new Date).getTime()/1E3);if(isNaN(a)){a=jSmart.prototype.PHPJS("strtotime","date_format").strtotime(a);if(a==-1||a===false)return Math.floor((new Date).getTime()/1E3);return a}a=
new String(a);if(a.length==14)return Math.floor((new Date(a.substr(0,4),a.substr(4,2)-1,a.substr(6,2),a.substr(8,2),a.substr(10,2))).getTime()/1E3);return parseInt(a)};jSmart.prototype.registerPlugin("function","__array",function(a){var b=[],c;for(c in a)if(a.hasOwnProperty(c)&&a[c]&&typeof a[c]!="function")b[c]=a[c];return b});jSmart.prototype.registerPlugin("function","__func",function(a,b){for(var c=[],d={},e=0;e<a.length;++e){c.push(a.name+"__p"+e);d[a.name+"__p"+e]=a[e]}return M(("__owner"in
b&&a.name in b.__owner?"__owner."+a.name:a.name)+"("+c.join(",")+")",F({},b,d))});jSmart.prototype.registerPlugin("function","__quoted",function(a){return a.join("")});jSmart.prototype.registerPlugin("function","append",function(a,b){var c=a.__get("var",null,0);if(!(c in b)||!(b[c]instanceof Array))b[c]=[];var d=a.__get("index",false),e=a.__get("value",null,1);if(d===false)b[c].push(e);else b[c][d]=e;return""});jSmart.prototype.registerPlugin("function","assign",function(a,b){r(a.__get("var",null,
0),a.__get("value",null,1),b);return""});jSmart.prototype.registerPlugin("function","call",function(a,b){var c=a.__get("name",null,0);delete a.name;var d=a.__get("assign",false);delete a.assign;c=t[c].process(a,b);if(d){r(d,c,b);return""}return c});jSmart.prototype.registerPlugin("block","capture",function(a,b,c){if(b){b=b.replace(/^\n/,"");c.smarty.capture[a.__get("name","default",0)]=b;"assign"in a&&r(a.assign,b,c);if(a=a.__get("append",false))if(a in c)c[a]instanceof Array&&c[a].push(b);else c[a]=
[b]}return""});jSmart.prototype.registerPlugin("function","counter",function(a,b){var c=a.__get("name","default");if(c in b.smarty.counter){var d=b.smarty.counter[c];if("start"in a)d.value=parseInt(a.start);else{d.value=parseInt(d.value);d.skip=parseInt(d.skip);if("down"==d.direction)d.value-=d.skip;else d.value+=d.skip}d.skip=a.__get("skip",d.skip);d.direction=a.__get("direction",d.direction);d.assign=a.__get("assign",d.assign)}else b.smarty.counter[c]={value:parseInt(a.__get("start",1)),skip:parseInt(a.__get("skip",
1)),direction:a.__get("direction","up"),assign:a.__get("assign",false)};if(b.smarty.counter[c].assign){b[b.smarty.counter[c].assign]=b.smarty.counter[c].value;return""}if(a.__get("print",true))return b.smarty.counter[c].value;return""});jSmart.prototype.registerPlugin("function","cycle",function(a,b){var c=a.__get("name","default"),d=a.__get("reset",false);if(!(c in b.smarty.cycle)){b.smarty.cycle[c]={arr:[""],delimiter:a.__get("delimiter",","),index:0};d=true}if(a.__get("delimiter",false))b.smarty.cycle[c].delimiter=
a.delimiter;var e=a.__get("values",false);if(e){var f=[];if(e instanceof Object)for(nm in e)f.push(e[nm]);else f=e.split(b.smarty.cycle[c].delimiter);if(f.length!=b.smarty.cycle[c].arr.length||f[0]!=b.smarty.cycle[c].arr[0]){b.smarty.cycle[c].arr=f;b.smarty.cycle[c].index=0;d=true}}if(a.__get("advance","true"))b.smarty.cycle[c].index+=1;if(b.smarty.cycle[c].index>=b.smarty.cycle[c].arr.length||d)b.smarty.cycle[c].index=0;if(a.__get("assign",false)){r(a.assign,b.smarty.cycle[c].arr[b.smarty.cycle[c].index],
b);return""}if(a.__get("print",true))return b.smarty.cycle[c].arr[b.smarty.cycle[c].index];return""});jSmart.prototype.print_r=function(a,b){if(a instanceof Object){var c=(a instanceof Array?"Array["+a.length+"]":"Object")+"<br>",d;for(d in a)if(a.hasOwnProperty(d))c+=b+"&nbsp;&nbsp;<strong>"+d+"</strong> : "+jSmart.prototype.print_r(a[d],b+"&nbsp;&nbsp;&nbsp;")+"<br>";return c}return a};jSmart.prototype.registerPlugin("function","debug",function(a,b){typeof dbgWnd!="undefined"&&dbgWnd.close();dbgWnd=
window.open("","","width=680,height=600,resizable,scrollbars=yes");var c="",d=0,e;for(e in b)c+="<tr class="+(++d%2?"odd":"even")+"><td><strong>"+e+"</strong></td><td>"+jSmart.prototype.print_r(b[e],"")+"</td></tr>";dbgWnd.document.write("                <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en'>                <head> \t\t            <title>jSmart Debug Console</title>                   <style type='text/css'>                      table {width: 100%;}                      td {vertical-align:top;width: 50%;}                      .even td {background-color: #fafafa;}                   </style>                </head>                <body>                   <h1>jSmart Debug Console</h1>                   <h2>assigned template variables</h2>                   <table>"+
c+"</table>                </body>                </html>             ");return""});jSmart.prototype.registerPlugin("function","eval",function(a,b){var c=[];j(a.__get("var","",0),c);c=m(c,b);if("assign"in a){r(a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("function","fetch",function(a,b){var c=jSmart.prototype.getFile(a.__get("file",null,0));if("assign"in a){r(a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("function","html_checkboxes",function(a,b){var c=a.__get("type",
"checkbox"),d=a.__get("name",c);if(c=="checkbox")d+="[]";var e=a.__get("values",a.options),f=a.__get("options",[]),g="options"in a,h;if(!g)for(h in a.output)f.push(a.output[h]);var i=a.__get("selected",false),k=a.__get("separator",""),q=Boolean(a.__get("labels",true)),n=[],E=0,u="";for(h in e)if(e.hasOwnProperty(h)){u=q?"<label>":"";u+='<input type="'+c+'" name="'+d+'" value="'+(g?h:e[h])+'" ';if(i==(g?h:e[h]))u+='checked="checked" ';u+="/>"+f[g?h:E++];u+=q?"</label>":"";u+=k;n.push(u)}if("assign"in
a){r(a.assign,n,b);return""}return n.join("\n")});jSmart.prototype.registerPlugin("function","html_image",function(a){var b=a.__get("file",null),c=a.__get("width",false),d=a.__get("height",false),e=a.__get("alt",""),f=a.__get("href",false),g={file:1,width:1,height:1,alt:1,href:1,basedir:1,path_prefix:1};b='<img src="'+a.__get("path_prefix","")+b+'" alt="'+e+'"'+(c?' width="'+c+'"':"")+(d?' height="'+d+'"':"");for(var h in a)if(a.hasOwnProperty(h)&&typeof a[h]=="string")h in g||(b+=" "+h+'="'+a[h]+
'"');b+=" />";return f?'<a href="'+f+'">'+b+"</a>":b});jSmart.prototype.registerPlugin("function","html_options",function(a){var b=a.__get("values",a.options),c=a.__get("options",[]),d="options"in a,e;if(!d)for(e in a.output)c.push(a.output[e]);var f=a.__get("selected",false),g=[],h="",i=0;for(e in b)if(b.hasOwnProperty(e)){h='<option value="'+(d?e:b[e])+'"';if(f==(d?e:b[e]))h+=' selected="selected"';h+=">"+c[d?e:i++]+"</option>";g.push(h)}a=a.__get("name",false);return(a?'<select name="'+a+'">\n'+
g.join("\n")+"\n</select>":g.join("\n"))+"\n"});jSmart.prototype.registerPlugin("function","html_radios",function(a,b){a.type="radio";return t.html_checkboxes.process(a,b)});jSmart.prototype.registerPlugin("function","html_select_date",function(a){a=a.__get("prefix","Date_");var b=["January","February","March","April","May","June","July","August","September","October","November","December"],c="";c+='<select name="'+a+'Month">\n';var d=0;for(d=0;d<b.length;++d)c+='<option value="'+d+'">'+b[d]+"</option>\n";
c+="</select>\n";c+='<select name="'+a+'Day">\n';for(d=0;d<31;++d)c+='<option value="'+d+'">'+d+"</option>\n";c+="</select>\n";return c});jSmart.prototype.registerPlugin("function","html_table",function(a){var b=[],c;if(a.loop instanceof Array)b=a.loop;else for(c in a.loop)a.loop.hasOwnProperty(c)&&b.push(a.loop[c]);var d=a.__get("rows",false),e=a.__get("cols",false);e||(e=d?Math.ceil(b.length/d):3);var f=[];if(isNaN(e)){if(typeof e=="object")for(c in e)e.hasOwnProperty(c)&&f.push(e[c]);else f=e.split(/\s*,\s*/);
e=f.length}d=d?d:Math.ceil(b.length/e);var g=a.__get("inner","cols");c=a.__get("caption","");var h=a.__get("table_attr",'border="1"'),i=a.__get("th_attr",false);if(i&&typeof i!="object")i=[i];var k=a.__get("tr_attr",false);if(k&&typeof k!="object")k=[k];var q=a.__get("td_attr",false);if(q&&typeof q!="object")q=[q];var n=a.__get("trailpad","&nbsp;"),E=a.__get("hdir","right"),u=a.__get("vdir","down");a="";for(var A=0;A<d;++A){a+="<tr"+(k?" "+k[A%k.length]:"")+">\n";for(var B=0;B<e;++B){var Y=g=="cols"?
(u=="down"?A:d-1-A)*e+(E=="right"?B:e-1-B):(E=="right"?B:e-1-B)*d+(u=="down"?A:d-1-A);a+="<td"+(q?" "+q[B%q.length]:"")+">"+(Y<b.length?b[Y]:n)+"</td>\n"}a+="</tr>\n"}b="";if(f.length){b="\n<thead><tr>";for(d=0;d<f.length;++d)b+="\n<th"+(i?" "+i[d%i.length]:"")+">"+f[E=="right"?d:f.length-1-d]+"</th>";b+="\n</tr></thead>"}return"<table "+h+">"+(c?"\n<caption>"+c+"</caption>":"")+b+"\n<tbody>\n"+a+"</tbody>\n</table>\n"});jSmart.prototype.registerPlugin("function","include",function(a,b){var c=a.__get("file",
null,0);if(!(c in J)){J[c]=[];var d=jSmart.prototype.getTemplate(c);if(typeof d!="string")throw Error("No template for "+c);j(R(d.replace(/\r\n/g,"\n")),J[c])}d=F({},b,a);d.smarty.template=c;c=m(J[c],d);if("assign"in a){r(a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("function","include_javascript",function(a,b){var c=a.__get("file",null,0);if(a.__get("once",true)&&c in S)return"";S[c]=true;c=M(jSmart.prototype.getJavascript(c),{$this:b});if("assign"in a){r(a.assign,c,b);return""}return c});
jSmart.prototype.registerPlugin("function","include_php",function(a,b){return t.include_javascript.process(a,b)});jSmart.prototype.registerPlugin("function","insert",function(a,b){var c={},d;for(d in a)if(a.hasOwnProperty(d)&&isNaN(d)&&a[d]&&typeof a[d]=="string"&&d!="name"&&d!="assign"&&d!="script")c[d]=a[d];d="insert_";if("script"in a){eval(jSmart.prototype.getJavascript(a.script));d="smarty_insert_"}c=eval(d+a.__get("name",null,0))(c,b);if("assign"in a){r(a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("block",
"javascript",function(a,b,c){c.$this=c;M(b,c);delete c.$this;return""});jSmart.prototype.registerPlugin("function","config_load",function(a,b){jSmart.prototype.configLoad(jSmart.prototype.getConfig(a.__get("file",null,0)),a.__get("section","",1),b);return""});jSmart.prototype.registerPlugin("function","mailto",function(a){var b=a.__get("address",null),c=a.__get("encode","none"),d=a.__get("text",b),e=jSmart.prototype.PHPJS("rawurlencode","mailto").rawurlencode(a.__get("cc","")).replace("%40","@"),
f=jSmart.prototype.PHPJS("rawurlencode","mailto").rawurlencode(a.__get("bcc","")).replace("%40","@"),g=jSmart.prototype.PHPJS("rawurlencode","mailto").rawurlencode(a.__get("followupto","")).replace("%40","@"),h=jSmart.prototype.PHPJS("rawurlencode","mailto").rawurlencode(a.__get("subject","")),i=jSmart.prototype.PHPJS("rawurlencode","mailto").rawurlencode(a.__get("newsgroups",""));a=a.__get("extra","");b+=e?"?cc="+e:"";b+=f?(e?"&":"?")+"bcc="+f:"";b+=h?(e||f?"&":"?")+"subject="+h:"";b+=i?(e||f||h?
"&":"?")+"newsgroups="+i:"";b+=g?(e||f||h||i?"&":"?")+"followupto="+g:"";s='<a href="mailto:'+b+'" '+a+">"+d+"</a>";if(c=="javascript"){s="document.write('"+s+"');";d="";for(c=0;c<s.length;++c)d+="%"+jSmart.prototype.PHPJS("bin2hex","mailto").bin2hex(s.substr(c,1));return'<script type="text/javascript">eval(unescape(\''+d+"'))<\/script>"}else if(c=="javascript_charcode"){d=[];for(c=0;c<s.length;++c)d.push(jSmart.prototype.PHPJS("ord","mailto").ord(s.substr(c,1)));return'<script type="text/javascript" language="javascript">\n<!--\n{document.write(String.fromCharCode('+
d.join(",")+"))}\n//--\>\n<\/script>\n"}else if(c=="hex"){if(b.match(/^.+\?.+$/))throw Error("mailto: hex encoding does not work with extra attributes. Try javascript.");e="";for(c=0;c<b.length;++c)e+=b.substr(c,1).match(/\w/)?"%"+jSmart.prototype.PHPJS("bin2hex","mailto").bin2hex(b.substr(c,1)):b.substr(c,1);b="";for(c=0;c<d.length;++c)b+="&#x"+jSmart.prototype.PHPJS("bin2hex","mailto").bin2hex(d.substr(c,1))+";";return'<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;'+e+'" '+a+">"+b+"</a>"}return s});
jSmart.prototype.registerPlugin("function","math",function(a,b){with(Math)with(a)var c=eval(a.__get("equation",null).replace(/pi\(\s*\)/g,"PI"));if("format"in a)c=jSmart.prototype.PHPJS("sprintf","math").sprintf(a.format,c);if("assign"in a){r(a.assign,c,b);return""}return c});jSmart.prototype.registerPlugin("block","nocache",function(a,b){return b});jSmart.prototype.registerPlugin("block","textformat",function(a,b,c){if(!b)return"";var d=a.__get("wrap",80),e=a.__get("wrap_char","\n"),f=a.__get("wrap_cut",
false),g=a.__get("indent_char"," "),h=a.__get("indent",0),i=Array(h+1).join(g),k=a.__get("indent_first",0);g=Array(k+1).join(g);if(a.__get("style","")=="email")d=72;b=b.split("\n");for(var q=0;q<b.length;++q){var n=b[q];if(n){n=n.replace(/^\s+|\s+$/,"").replace(/\s+/g," ");if(k)n=g+n;n=N.wordwrap(n,d-h,e,f);if(h)n=n.replace(/^/mg,i);b[q]=n}}d=b.join(e+e);if("assign"in a){r(a.assign,d,c);return""}return d});jSmart.prototype.registerPlugin("block","while",function(a,b,c,d){if(b){d.value=Boolean(a[0]);
return d.value?b.replace(/^\n/,""):""}});jSmart.prototype.registerPlugin("modifier","capitalize",function(a,b){var c=RegExp(b?"[\\W\\d]+":"\\W+"),d=null,e="";for(d=a.match(c);d;d=a.match(c)){var f=a.slice(0,d.index);e+=f.match(/\d/)?f:f.charAt(0).toUpperCase()+f.slice(1);e+=a.slice(d.index,d.index+d[0].length);a=a.slice(d.index+d[0].length)}if(a.match(/\d/))return e+a;return e+a.charAt(0).toUpperCase()+a.slice(1)});jSmart.prototype.registerPlugin("modifier","cat",function(a,b){b=b?b:"";return a+b});
jSmart.prototype.registerPlugin("modifier","count_characters",function(a,b){return b?a.length:a.replace(/\s/g,"").length});jSmart.prototype.registerPlugin("modifier","count_paragraphs",function(a){if(a=a.match(/\n+/g))return a.length+1;return 1});jSmart.prototype.registerPlugin("modifier","count_sentences",function(a){if(a=a.match(/[^\s]\.(?!\w)/g))return a.length;return 0});jSmart.prototype.registerPlugin("modifier","count_words",function(a){if(a=a.match(/\w+/g))return a.length;return 0});jSmart.prototype.registerPlugin("modifier",
"date_format",function(a,b,c){return jSmart.prototype.PHPJS("strftime","date_format").strftime(b?b:"%b %e, %Y",jSmart.prototype.makeTimeStamp(a?a:c))});jSmart.prototype.registerPlugin("modifier","defaultValue",function(a,b){return a&&a!="null"&&a!="undefined"?a:b?b:""});jSmart.prototype.registerPlugin("modifier","escape",function(a,b,c){b=b||"html";c=c||"UTF-8";switch(b){case "html":return jSmart.prototype.PHPJS("htmlspecialchars","escape").htmlspecialchars(a,3,c);case "htmlall":return jSmart.prototype.PHPJS("htmlentities",
"escape").htmlentities(a,3,c);case "url":return jSmart.prototype.PHPJS("rawurlencode","escape").rawurlencode(a);case "urlpathinfo":return jSmart.prototype.PHPJS("rawurlencode","escape").rawurlencode(a).replace(/%2F/g,"/");case "quotes":return a.replace(/([^\\])'/,"$1\\'");case "hex":b="";for(c=0;c<a.length;++c)b+="%"+jSmart.prototype.PHPJS("bin2hex","escape").bin2hex(a.substr(c,1));return b;case "hexentity":b="";for(c=0;c<a.length;++c)b+="&#x"+jSmart.prototype.PHPJS("bin2hex","escape").bin2hex(a.substr(c,
1)).toUpperCase()+";";return b;case "decentity":b="";for(c=0;c<a.length;++c)b+="&#"+jSmart.prototype.PHPJS("ord","escape").ord(a.substr(c,1))+";";return b;case "mail":return a.replace(/@/g," [AT] ").replace(/[.]/g," [DOT] ");case "nonstd":b="";for(c=0;c<a.length;++c){var d=jSmart.prototype.PHPJS("ord","escape").ord(a.substr(c,1));b+=d>=126?"&#"+d+";":a.substr(c,1)}return b;case "javascript":return a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/<\//g,
"</")}return a});jSmart.prototype.registerPlugin("modifier","indent",function(a,b,c){b=b?b:4;c=c?c:" ";for(var d="";b--;)d+=c;b=a.match(/\n+$/);return d+a.replace(/\n+$/,"").replace(/\n/g,"\n"+d)+(b?b[0]:"")});jSmart.prototype.registerPlugin("modifier","lower",function(a){return a.toLowerCase()});jSmart.prototype.registerPlugin("modifier","nl2br",function(a){return a.replace(/\n/g,"<br />\n")});jSmart.prototype.registerPlugin("modifier","regex_replace",function(a,b,c){b=b.match(/^ *\/(.*)\/(.*) *$/);
return(new String(a)).replace(RegExp(b[1],"g"+(b.length>1?b[2]:"")),c)});jSmart.prototype.registerPlugin("modifier","replace",function(a,b,c){if(!b)return a;a=new String(a);b=new String(b);c=new String(c);var d="",e=-1;for(e=a.indexOf(b,e);e>=0;e=a.indexOf(b,e)){d+=a.slice(0,e)+c;e+=b.length;a=a.slice(e)}return d+a});jSmart.prototype.registerPlugin("modifier","spacify",function(a,b){b||(b=" ");return a.replace(/(\n|.)(?!$)/g,"$1"+b)});jSmart.prototype.registerPlugin("modifier","string_format",function(a,
b){return jSmart.prototype.PHPJS("sprintf","string_format").sprintf(b,a)});jSmart.prototype.registerPlugin("modifier","strip",function(a,b){b=b?b:" ";return(new String(a)).replace(/[\s]+/g,b)});jSmart.prototype.registerPlugin("modifier","strip_tags",function(a,b){b=b==null?true:b;return(new String(a)).replace(/<[^>]*?>/g,b?" ":"")});jSmart.prototype.registerPlugin("modifier","truncate",function(a,b,c,d,e){b=b?b:80;c=c!=null?c:"...";if(a.length<=b)return a;b-=Math.min(b,c.length);if(e)return a.slice(0,
Math.floor(b/2))+c+a.slice(a.length-Math.floor(b/2));d||(a=a.slice(0,b+1).replace(/\s+?(\S+)?$/,""));return a.slice(0,b)+c});jSmart.prototype.registerPlugin("modifier","upper",function(a){return a.toUpperCase()});jSmart.prototype.registerPlugin("modifier","wordwrap",function(a,b,c,d){b=b||80;c=c||"\n";a=a.split("\n");for(var e=0;e<a.length;++e){for(var f=a[e],g="";f.length>b;){for(var h=0,i=f.slice(h).match(/\s+/);i&&h+i.index<=b;i=f.slice(h).match(/\s+/))h+=i.index+i[0].length;h=h||(d?b:i?i.index+
i[0].length:f.length);g+=f.slice(0,h).replace(/\s+$/,"");if(h<f.length)g+=c;f=f.slice(h)}a[e]=g+f}return a.join("\n")});String.prototype.fetch=function(a){return(new jSmart(this)).fetch(a)}})();
